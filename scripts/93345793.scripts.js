var OptionCheckbox=React.createClass({displayName:"OptionCheckbox",render:function(){return React.createElement("label",{htmlFor:"option-"+this.props.questionId+"-"+this.props.value,className:"pure-checkbox"},React.createElement("input",{id:"option-"+this.props.questionId+"-"+this.props.value,type:"checkbox",name:this.props.questionId,value:this.props.value})," ",this.props.text)}}),OptionRadio=React.createClass({displayName:"OptionRadio",render:function(){return React.createElement("label",{htmlFor:"option-"+this.props.questionId+"-"+this.props.value,className:"pure-radio"},React.createElement("input",{id:"option-"+this.props.questionId+"-"+this.props.value,type:"radio",name:this.props.questionId,value:this.props.value})," ",this.props.text)}}),OptionList=React.createClass({displayName:"OptionList",render:function(){var a,b,c=this.props.options.questionId;return this.props.options.acceptsMultipleOptions?b=this.props.options.values.map(function(a){return React.createElement(OptionCheckbox,{key:a.key,text:a.text,value:a.optionId,questionId:c})}):a=this.props.options.values.map(function(a){return React.createElement(OptionRadio,{key:a.key,text:a.text,value:a.optionId,questionId:c})}),React.createElement("div",null,a||b)}}),Question=React.createClass({displayName:"Question",render:function(){return React.createElement("section",{className:"question"},React.createElement("header",{className:"question-header"},React.createElement("h2",{className:"question-title"},this.props.title)),React.createElement("div",{className:"question-options"},React.createElement(OptionList,{options:this.props.options})))}}),QuestionList=React.createClass({displayName:"QuestionList",getInitialState:function(){var a=this.props.questions.map(function(a){return React.createElement(Question,{key:a.key,title:a.title,options:a.options})});return{questions:a,sessionId:this.props.sessionId}},clearQuestionsByList:function(a){for(var b=this.state.questions,c=0;c<a.length;c++)b=b.filter(function(b){return b.key!=a[c].get("question").id});this.setState({questions:b})},handleSubmit:function(a){a.preventDefault();var b=this,c=$("#submit"),d="pure-button-disabled";c.addClass(d);var e=Parse.Object.extend("Session"),f=new e;f.id=this.props.sessionId;for(var g=[],h=$("#survey-form").serializeArray(),i=Parse.Object.extend("Question"),j=Parse.Object.extend("Option"),k=Parse.Object.extend("Result"),l=0;l<h.length;l++){var m=new i;m.id=h[l].name,m.addUnique("sessions",f);var n=new j;n.id=h[l].value;var o=new k;o.set("question",m),o.set("answer",n),o.set("session",f),g.push(o)}Parse.Object.saveAll(g).then(function(a){console.log("Saved answers",a),b.clearQuestionsByList(a)},function(a){console.log("Error",a)}).then(function(){c.removeClass(d)})},render:function(){return this.state.questions.length>0?React.createElement("form",{id:"survey-form",onSubmit:this.handleSubmit,className:"pure-form"},React.createElement("div",null,this.state.questions),React.createElement("input",{id:"submit",type:"submit",value:"Submit",className:"pure-button pure-button-primary"})):React.createElement("p",null,"There are no more questions for you at the moment. Please try again shortly.")}});!function(a){"use strict";a.credentials=function(){return{parse:{appId:"X7orCVYTq6fV5b3Ub8SbjXafpGyeJPGCA4wlvxnH",jsKey:"e8NndbRxFwtvRcbDhRbmecNRNkZHz0W4sEijfwK9"},cookieKey:"apidays15-sessionId"}}()}(APIDAYS),function(a){"use strict";a.questions=function(){var a=function(a){var b=[],c=Parse.Object.extend("Question"),d=new Parse.Query(c);d.equalTo("available",!0),d.notEqualTo("sessions",{__type:"Pointer",className:"Session",objectId:a}),d.include("options"),d.find({success:function(c){for(var d=0;d<c.length;d++){for(var e=[],f=c[d],g=f.get("options"),h=0;h<g.length;h++){var i=g[h],j=i.get("text");e.push({text:j,optionId:g[h].id,key:g[h].id})}b.push({key:c[d].id,title:c[d].get("title"),options:{questionId:c[d].id,acceptsMultipleOptions:c[d].get("acceptsMultipleOptions"),values:e}})}React.render(React.createElement(QuestionList,{questions:b,sessionId:a}),document.getElementById("questions"))},error:function(a){console.error("Error: "+a.code+" "+a.message)}})};return{init:a}}()}(APIDAYS),"undefined"==typeof console&&(window.console={},console.log=console.error=console.info=console.debug=console.warn=console.trace=console.dir=console.dirxml=console.group=console.groupEnd=console.time=console.timeEnd=console.assert=console.profile=function(){}),function(a){"use strict";a.init=function(){if(Parse.initialize(a.credentials.parse.appId,a.credentials.parse.jsKey),!Cookies.enabled)return void $("#questions").html("<p>You must have cookies enabled.</p>");var b=Cookies.get(a.credentials.cookieKey);if(b)a.questions.init(b);else{var c=Parse.Object.extend("Session"),d=new c;$.getJSON("http://api.ipify.org?format=jsonp&callback=?",function(b){d.set("ip",b.ip),d.save().then(function(b){Cookies.set(a.credentials.cookieKey,b.id,{expires:new Date(2015,0,1)}),a.questions.init(b.id)},function(){console.error("Could not create session")})})}},$(document).ready(function(){a.init()})}(APIDAYS);